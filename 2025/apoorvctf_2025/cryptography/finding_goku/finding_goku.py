from pwn import *

def solution(host: str, port: str) -> str:
    r'''
    $ git clone https://github.com/cr-marcstevens/hashclash
    $ cd hashclash # and build
    $ mkdir ctf
    $ cd ctf
    $ echo -n "GOKU" > prefix.txt
    $ ../scripts/generic_ipc.sh prefix.txt
    $ hexdump -v -e '/1 "%02X"' collision1.bin
    -> 474F4B55C122B08503CCE2246346A496BFD8477357982ED625ACB624408EC40015DE89314C892B6356816DADA21D53F752DB38ABF169FB738E546C860D501C2C336675D2B761E7EAF88196DBC4A975BE47B24CD5C8244C77658FE3E55EC2B32E4F4A3EA5E3F49C56AD3DEF1A3541AED08EC259581916E8C46A855A7063F84FBA 
    $ hexdump -v -e '/1 "%02X"' collision2.bin
    -> 474F4B55C122B08503CDE2246346A496BFD8477357982ED625ACB624408EC40015DE89314C892B6356816DADA21D53F752DB38ABF169FB738E546C860D501C2C336675D2B761E7EAF88096DBC4A975BE47B24CD5C8244C77658FE3E55EC2B32E4F4A3EA5E3F49C56AD3DEF1A3541AED08EC259581916E8C46A855A7063F84FBA
    '''
    flag = ""
    context.update({"log_level":"error"})
    with remote(host, port) as r:
        HEX1 = b"474F4B55C122B08503CCE2246346A496BFD8477357982ED625ACB624408EC40015DE89314C892B6356816DADA21D53F752DB38ABF169FB738E546C860D501C2C336675D2B761E7EAF88196DBC4A975BE47B24CD5C8244C77658FE3E55EC2B32E4F4A3EA5E3F49C56AD3DEF1A3541AED08EC259581916E8C46A855A7063F84FBA"
        HEX2 = b"474F4B55C122B08503CDE2246346A496BFD8477357982ED625ACB624408EC40015DE89314C892B6356816DADA21D53F752DB38ABF169FB738E546C860D501C2C336675D2B761E7EAF88096DBC4A975BE47B24CD5C8244C77658FE3E55EC2B32E4F4A3EA5E3F49C56AD3DEF1A3541AED08EC259581916E8C46A855A7063F84FBA"
        r = remote(host, port)
        r.recvuntil(b"Enter first hex data: ")
        r.sendline(HEX1)
        r.recvuntil(b"Enter second hex data: ")
        r.sendline(HEX2)
        r.recvuntil(b"You have found the real Goku! Your flag is: ")
        flag = r.recvall().decode().strip()
    return flag

if __name__ == "__main__":
    host = "chals1.apoorvctf.xyz"
    port = "5002"
    print(solution(host, port))
    